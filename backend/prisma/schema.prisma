// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String     @id @default(cuid())
  name         String
  email        String     @unique
  passwordHash String
  points       Int        @default(0)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  
  // Relations
  wasteLogs    WasteLog[]

  @@map("users")
}

model WasteItem {
  id                   String     @id @default(cuid())
  name                 String     @unique
  category             WasteCategory
  disposalInstructions String
  binType              BinType
  points               Int        @default(1)
  createdAt            DateTime   @default(now())
  updatedAt            DateTime   @updatedAt
  
  // Relations
  wasteLogs            WasteLog[]

  @@map("waste_items")
}

model Bin {
  id        String   @id @default(cuid())
  name      String
  latitude  Float
  longitude Float
  type      BinType
  isFull    Boolean  @default(false)
  capacity  Int      @default(100)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("bins")
}

model WasteLog {
  id          String    @id @default(cuid())
  userId      String
  wasteItemId String
  quantity    Int       @default(1)
  points      Int       @default(1)
  timestamp   DateTime  @default(now())
  area        String?   // Added for location tracking
  
  // Relations
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  wasteItem   WasteItem @relation(fields: [wasteItemId], references: [id], onDelete: Cascade)

  @@map("waste_logs")
}

model ValuableMaterial {
  id          String   @id @default(cuid())
  name        String   @unique
  description String
  imageUrl    String?
  valueLevel  ValueLevel @default(MEDIUM)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("valuable_materials")
}

model ScrapPrice {
  id           String   @id @default(cuid())
  materialName String   @unique
  pricePerKg   Float
  updatedAt    DateTime @updatedAt
  createdAt    DateTime @default(now())

  @@map("scrap_prices")
}

model PublicToilet {
  id                    String    @id @default(cuid())
  name                  String
  address               String
  latitude              Float
  longitude             Float
  rating                Float     @default(0)
  reviews               Int       @default(0)
  accessibility         Boolean   @default(false)
  wifi                  Boolean   @default(false)
  parking               Boolean   @default(false)
  babyFacilities        Boolean   @default(false)
  isEcoFriendly         Boolean   @default(false)
  status                ToiletStatus @default(OPEN)
  openHours             String?
  features              String[]  @default([])
  amenities             String[]  @default([])
  lastCleaned           DateTime?
  cleanlinessRating     Float     @default(0)
  waitTime              String?
  imageUrl              String?
  sustainabilityScore   Int       @default(0)
  carbonFootprint       String?
  waterSaved            String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@map("public_toilets")
}

enum WasteCategory {
  WET
  DRY
  E_WASTE
  HAZARDOUS
  RECYCLABLE
}

enum BinType {
  WET
  DRY
  E_WASTE
  HAZARDOUS
  RECYCLABLE
}

enum ValueLevel {
  LOW
  MEDIUM
  HIGH
}

enum ToiletStatus {
  OPEN
  CLOSED
  MAINTENANCE
  TEMPORARILY_CLOSED
}
